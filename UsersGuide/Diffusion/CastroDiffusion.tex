\section{Introduction}

Castro incorporates explicit thermal diffusion into the energy equation.  
In terms of the specific internal energy, $e$, this appears as:
\begin{equation}
\rho \frac{De}{Dt} + p \nabla \cdot U = \nabla \cdot k_\mathrm{th} \nabla T
\end{equation}
where $k_\mathrm{th}$ is the thermal conductivity, with units
$\mathrm{erg~cm^{-1}~s^{-1}~K^{-1}}$.

To see the similarity to the thermal diffusion equation, consider the special
case of constant conductivity, $k_\mathrm{th}$, and density, and assume an
ideal gas, so $e = c_v T$, where $c_v$ is the specific heat at constant volume.
Finally, ignore hydrodynamics, so $U = 0$.  This gives:
\begin{equation}
\frac{\partial T}{\partial t} = D \nabla^2 T
\end{equation}
where $D \equiv k_\mathrm{th}/(\rho c_v)$.  Solving this equation explicitly requires
a timestep limiter of
\begin{equation}
\Delta t_\mathrm{diff} \le \frac{1}{2} \frac{\Delta x^2}{D}
\end{equation}

Support for diffusion must be compiled into the code by setting
{\tt USE\_DIFFUSION = TRUE} in your {\tt GNUmakefile}.


The following parameters affect diffusion:
\begin{itemize}
\item {\tt castro.diffuse\_temp}:  enable thermal diffusion (0 or 1; default 0)

\item {\tt diffusion.diff\_coeff}: {\color{red} no longer supported?}
\end{itemize}

A pure diffusion problem (with no hydrodynamics) can be run by setting
\begin{verbatim}
castro.diffuse_temp = 1
castro.do_hydro = 0
\end{verbatim}

To complete the setup, a thermal conductivity must be specified.
This is done by a problem-specific routine {\tt ca\_fill\_temp\_cond},
which has the calling sequence:
\begin{verbatim}
BL_FORT_PROC_CALL(CA_FILL_TEMP_COND,ca_fill_temp_cond)
               (bx.loVect(), bx.hiVect(),
                BL_TO_FORTRAN(state_old[mfi]),
                D_DECL(BL_TO_FORTRAN(coeffs[0][mfi]),
                       BL_TO_FORTRAN(coeffs[1][mfi]),
                       BL_TO_FORTRAN(coeffs[2][mfi])),
                dx_fine);
\end{verbatim}
This passes in the current state and returns the thermal conductivity
on all the edges of the zone.

